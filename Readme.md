this is the dev b final updated code